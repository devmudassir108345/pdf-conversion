


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professional Word to PDF Converter</title>
    <link rel="stylesheet" href="/static/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
    --primary-color: #4a6bff;
    --secondary-color: #f8f9fa;
    --text-color: #333;
    --light-text: #777;
    --border-color: #e0e0e0;
    --success-color: #28a745;
    --error-color: #dc3545;
    --warning-color: #ffc107;
    --box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    --transition: all 0.3s ease;
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Poppins', sans-serif;
    line-height: 1.6;
    color: var(--text-color);
    background-color: #f5f7ff;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem;
}

header {
    text-align: center;
    margin-bottom: 3rem;
}

header h1 {
    font-size: 2.5rem;
    color: var(--primary-color);
    margin-bottom: 0.5rem;
}

header p {
    color: var(--light-text);
    font-size: 1.1rem;
}

.converter-container {
    background-color: white;
    border-radius: 10px;
    box-shadow: var(--box-shadow);
    padding: 2rem;
    margin-bottom: 3rem;
    text-align: center;
}

.drop-zone {
    border: 2px dashed var(--border-color);
    border-radius: 8px;
    padding: 3rem 2rem;
    cursor: pointer;
    transition: var(--transition);
}

.drop-zone.highlight {
    border-color: var(--primary-color);
    background-color: rgba(74, 107, 255, 0.05);
}

.drop-zone i {
    font-size: 3rem;
    color: var(--primary-color);
    margin-bottom: 1rem;
}

.drop-zone h3 {
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
}

.drop-zone p {
    color: var(--light-text);
    margin-bottom: 1.5rem;
}

input[type="file"] {
    display: none;
}

.btn-select {
    background-color: var(--primary-color);
    color: white;
    border: none;
    padding: 0.8rem 2rem;
    border-radius: 5px;
    font-size: 1rem;
    cursor: pointer;
    transition: var(--transition);
    margin-bottom: 1.5rem;
}

.btn-select:hover {
    background-color: #3a5bef;
}

.cloud-services {
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid var(--border-color);
}

.cloud-services span {
    display: block;
    color: var(--light-text);
    margin-bottom: 1rem;
}

.btn-cloud {
    background-color: white;
    border: 1px solid var(--border-color);
    color: var(--text-color);
    padding: 0.6rem 1.5rem;
    border-radius: 5px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: var(--transition);
    margin: 0 0.5rem;
}

.btn-cloud:hover {
    background-color: var(--secondary-color);
}

.btn-cloud i {
    margin-right: 0.5rem;
}

.file-list-container {
    text-align: left;
}

.file-list-container h3 {
    margin-bottom: 1rem;
    font-size: 1.2rem;
    color: var(--text-color);
}

.file-list {
    max-height: 300px;
    overflow-y: auto;
    margin-bottom: 1.5rem;
    border: 1px solid var(--border-color);
    border-radius: 5px;
}

.file-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.8rem 1rem;
    border-bottom: 1px solid var(--border-color);
    transition: var(--transition);
}

.file-item:last-child {
    border-bottom: none;
}

.file-item:hover {
    background-color: var(--secondary-color);
}

.file-info {
    display: flex;
    align-items: center;
    flex-grow: 1;
    min-width: 0;
}

.file-info i {
    color: var(--primary-color);
    margin-right: 1rem;
    font-size: 1.2rem;
}

.file-name {
    flex-grow: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    margin-right: 1rem;
}

.file-size {
    color: var(--light-text);
    font-size: 0.9rem;
    white-space: nowrap;
}

.btn-remove {
    background: none;
    border: none;
    color: var(--light-text);
    cursor: pointer;
    padding: 0.5rem;
    margin-left: 0.5rem;
    transition: var(--transition);
}

.btn-remove:hover {
    color: var(--error-color);
}

.file-actions {
    display: flex;
    justify-content: space-between;
}

.btn-reset {
    background-color: white;
    border: 1px solid var(--error-color);
    color: var(--error-color);
    padding: 0.8rem 1.5rem;
    border-radius: 5px;
    font-size: 1rem;
    cursor: pointer;
    transition: var(--transition);
}

.btn-reset:hover {
    background-color: rgba(220, 53, 69, 0.1);
}

.btn-convert {
    background-color: var(--primary-color);
    color: white;
    border: none;
    padding: 0.8rem 1.5rem;
    border-radius: 5px;
    font-size: 1rem;
    cursor: pointer;
    transition: var(--transition);
}

.btn-convert:hover {
    background-color: #3a5bef;
}

.progress-container {
    padding: 2rem;
    text-align: left;
}

.progress-info {
    display: flex;
    align-items: center;
    margin-bottom: 1rem;
}

.progress-bar {
    flex-grow: 1;
    height: 10px;
    background-color: var(--secondary-color);
    border-radius: 5px;
    overflow: hidden;
}

.progress {
    height: 100%;
    width: 0;
    background-color: var(--primary-color);
    transition: width 0.3s ease;
}

.progress-text {
    margin-left: 1rem;
    font-weight: 500;
    min-width: 40px;
}

.progress-status {
    margin-bottom: 1.5rem;
    font-weight: 500;
}

.conversion-details {
    margin-top: 1.5rem;
}

.error-message {
    display: flex;
    align-items: center;
    padding: 1rem;
    background-color: rgba(220, 53, 69, 0.1);
    border-radius: 5px;
    margin-bottom: 1rem;
    color: var(--error-color);
}

.error-message i {
    margin-right: 0.8rem;
}

.btn-retry {
    background-color: var(--primary-color);
    color: white;
    border: none;
    padding: 0.8rem 1.5rem;
    border-radius: 5px;
    font-size: 1rem;
    cursor: pointer;
    transition: var(--transition);
}

.btn-retry:hover {
    background-color: #3a5bef;
}

.result-container {
    text-align: left;
}

.result-header {
    text-align: center;
    margin-bottom: 2rem;
}

.result-header i {
    font-size: 4rem;
    color: var(--success-color);
    margin-bottom: 1.5rem;
}

.result-header h3 {
    font-size: 1.5rem;
    margin-bottom: 0.5rem;
}

.result-header p {
    color: var(--light-text);
}

.download-list {
    max-height: 400px;
    overflow-y: auto;
    margin-bottom: 2rem;
    border: 1px solid var(--border-color);
    border-radius: 5px;
}

.result-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem;
    border-bottom: 1px solid var(--border-color);
}

.result-item:last-child {
    border-bottom: none;
}

.result-info {
    display: flex;
    align-items: center;
    flex-grow: 1;
    min-width: 0;
}

.result-info i {
    margin-right: 1rem;
    font-size: 1.5rem;
}

.result-info i.success {
    color: var(--success-color);
}

.result-info i.error {
    color: var(--error-color);
}

.original-name {
    font-weight: 500;
    margin-bottom: 0.3rem;
}

.converted-name {
    color: var(--light-text);
    font-size: 0.9rem;
}

.error-msg {
    color: var(--error-color);
    font-size: 0.9rem;
}

.result-item.error {
    background-color: rgba(220, 53, 69, 0.05);
}

.btn-download {
    background-color: var(--success-color);
    color: white;
    border: none;
    padding: 0.6rem 1.2rem;
    border-radius: 5px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: var(--transition);
    text-decoration: none;
    white-space: nowrap;
    margin-left: 1rem;
}

.btn-download:hover {
    background-color: #218838;
}

.btn-download i {
    margin-right: 0.5rem;
}

.btn-convert-another {
    background-color: white;
    border: 1px solid var(--primary-color);
    color: var(--primary-color);
    padding: 0.8rem 2rem;
    border-radius: 5px;
    font-size: 1rem;
    cursor: pointer;
    transition: var(--transition);
    display: block;
    width: 100%;
    max-width: 300px;
    margin: 0 auto;
}

.btn-convert-another:hover {
    background-color: var(--primary-color);
    color: white;
}

.btn-convert-another i {
    margin-right: 0.5rem;
}

.features {
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 2rem;
    margin-bottom: 3rem;
}

.feature {
    flex: 1;
    min-width: 250px;
    background-color: white;
    border-radius: 10px;
    padding: 2rem;
    box-shadow: var(--box-shadow);
    text-align: center;
}

.feature i {
    font-size: 2.5rem;
    color: var(--primary-color);
    margin-bottom: 1.5rem;
}

.feature h3 {
    font-size: 1.3rem;
    margin-bottom: 1rem;
}

.feature p {
    color: var(--light-text);
}

footer {
    text-align: center;
    padding: 2rem;
    color: var(--light-text);
    font-size: 0.9rem;
}

.alert {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background-color: var(--error-color);
    color: white;
    padding: 1rem 1.5rem;
    border-radius: 5px;
    display: flex;
    align-items: center;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
    z-index: 1000;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.alert.show {
    opacity: 1;
}

.alert i {
    margin-right: 0.8rem;
}

.btn-close {
    background: none;
    border: none;
    color: white;
    margin-left: 1rem;
    cursor: pointer;
}

@media (max-width: 768px) {
    .container {
        padding: 1rem;
    }
    
    header h1 {
        font-size: 2rem;
    }
    
    .features {
        flex-direction: column;
    }
    
    .file-actions {
        flex-direction: column;
        gap: 1rem;
    }
    
    .btn-reset, .btn-convert {
        width: 100%;
    }
    
    .result-item {
        flex-direction: column;
        align-items: flex-start;
        gap: 1rem;
    }
    
    .btn-download {
        margin-left: 0;
        width: 100%;
        text-align: center;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Word to PDF Converter</h1>
            <p>Convert your Word documents to PDF with 100% accuracy</p>
        </header>

        <div class="converter-container">
            <div class="drop-zone" id="dropZone">
                <i class="fas fa-file-word"></i>
                <h3>Select or drop your Word files here</h3>
                <p>DOC, DOCX (Max 16MB each, up to 10 files)</p>
                <input type="file" id="fileInput" accept=".doc,.docx" multiple>
                <button class="btn-select">Select Files</button>
                <div class="cloud-services">
                    <span>or import from:</span>
                    <button class="btn-cloud" id="googleDriveBtn"><i class="fab fa-google-drive"></i> Google Drive</button>
                    <button class="btn-cloud" id="dropboxBtn"><i class="fab fa-dropbox"></i> Dropbox</button>
                </div>
            </div>

            <div class="file-list-container" id="fileListContainer" style="display: none;">
                <h3>Selected Files</h3>
                <div class="file-list" id="fileList"></div>
                <div class="file-actions">
                    <button class="btn-reset" id="resetBtn"><i class="fas fa-redo"></i> Reset</button>
                    <button class="btn-convert" id="convertBtn"><i class="fas fa-cog"></i> Convert All</button>
                </div>
            </div>

            <div class="progress-container" id="progressContainer" style="display: none;">
                <div class="progress-info">
                    <div class="progress-bar">
                        <div class="progress" id="progressBar"></div>
                    </div>
                    <span id="progressText">0%</span>
                </div>
                <p id="progressStatus">Preparing files for conversion...</p>
                <div class="conversion-details" id="conversionDetails"></div>
            </div>

            <div class="result-container" id="resultContainer" style="display: none;">
                <div class="result-header">
                    <i class="fas fa-file-pdf"></i>
                    <h3>Conversion Complete</h3>
                    <p id="resultSummary">All files converted successfully</p>
                </div>
                <div class="download-list" id="downloadList"></div>
                <button class="btn-convert-another" id="convertAnotherBtn">
                    <i class="fas fa-plus"></i> Convert More Files
                </button>
            </div>
        </div>

        <div class="features">
            <div class="feature">
                <i class="fas fa-shield-alt"></i>
                <h3>Secure Processing</h3>
                <p>Files are processed securely and automatically deleted after conversion.</p>
            </div>
            <div class="feature">
                <i class="fas fa-tachometer-alt"></i>
                <h3>Batch Conversion</h3>
                <p>Convert multiple Word files to PDF simultaneously.</p>
            </div>
            <div class="feature">
                <i class="fas fa-check-circle"></i>
                <h3>100% Accuracy</h3>
                <p>Preserves all formatting and layout from your original documents.</p>
            </div>
        </div>
    </div>

    <footer>
        <p>© 2023 Professional Word to PDF Converter. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const dropZone = document.getElementById('dropZone');
            const fileInput = document.getElementById('fileInput');
            const selectBtn = dropZone.querySelector('.btn-select');
            const fileListContainer = document.getElementById('fileListContainer');
            const fileList = document.getElementById('fileList');
            const resetBtn = document.getElementById('resetBtn');
            const convertBtn = document.getElementById('convertBtn');
            const progressContainer = document.getElementById('progressContainer');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            const progressStatus = document.getElementById('progressStatus');
            const conversionDetails = document.getElementById('conversionDetails');
            const resultContainer = document.getElementById('resultContainer');
            const downloadList = document.getElementById('downloadList');
            const resultSummary = document.getElementById('resultSummary');
            const convertAnotherBtn = document.getElementById('convertAnotherBtn');
            const googleDriveBtn = document.getElementById('googleDriveBtn');
            const dropboxBtn = document.getElementById('dropboxBtn');

            // State
            let selectedFiles = [];
            let conversionResults = [];

            // Initialize
            initEventListeners();

            function initEventListeners() {
                // File selection
                selectBtn.addEventListener('click', () => fileInput.click());
                fileInput.addEventListener('change', handleFileSelect);

                // Drag and drop
                ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                    dropZone.addEventListener(eventName, preventDefaults, false);
                });

                ['dragenter', 'dragover'].forEach(eventName => {
                    dropZone.addEventListener(eventName, highlight, false);
                });

                ['dragleave', 'drop'].forEach(eventName => {
                    dropZone.addEventListener(eventName, unhighlight, false);
                });

                dropZone.addEventListener('drop', handleDrop, false);

                // Buttons
                resetBtn.addEventListener('click', resetFiles);
                convertBtn.addEventListener('click', convertFiles);
                convertAnotherBtn.addEventListener('click', resetConverter);
            }

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            function highlight() {
                dropZone.classList.add('highlight');
            }

            function unhighlight() {
                dropZone.classList.remove('highlight');
            }

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = Array.from(dt.files).filter(file => 
                    file.name.match(/\.(doc|docx)$/i)
                );
                
                if (files.length > 0) {
                    addFiles(files);
                }
            }

            function handleFileSelect(e) {
                const files = Array.from(e.target.files).filter(file => 
                    file.name.match(/\.(doc|docx)$/i)
                );
                
                if (files.length > 0) {
                    addFiles(files);
                }
            }

            function addFiles(files) {
                // Check if adding these files would exceed the maximum
                if (selectedFiles.length + files.length > 10) {
                    showAlert('You can only convert up to 10 files at once');
                    return;
                }

                // Add new files (avoid duplicates)
                files.forEach(file => {
                    if (!selectedFiles.some(f => f.name === file.name && f.size === file.size)) {
                        selectedFiles.push(file);
                    }
                });

                updateFileList();
                showFileList();
            }

            function updateFileList() {
                fileList.innerHTML = '';
                
                selectedFiles.forEach((file, index) => {
                    const fileItem = document.createElement('div');
                    fileItem.className = 'file-item';
                    fileItem.innerHTML = `
                        <div class="file-info">
                            <i class="fas fa-file-word"></i>
                            <span class="file-name">${file.name}</span>
                            <span class="file-size">${formatFileSize(file.size)}</span>
                        </div>
                        <button class="btn-remove" data-index="${index}">
                            <i class="fas fa-times"></i>
                        </button>
                    `;
                    fileList.appendChild(fileItem);
                });

                // Add event listeners to remove buttons
                document.querySelectorAll('.btn-remove').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        selectedFiles.splice(index, 1);
                        updateFileList();
                        
                        if (selectedFiles.length === 0) {
                            hideFileList();
                        }
                    });
                });
            }

            function showFileList() {
                dropZone.style.display = 'none';
                fileListContainer.style.display = 'block';
            }

            function hideFileList() {
                fileListContainer.style.display = 'none';
                dropZone.style.display = 'block';
            }

            function resetFiles() {
                selectedFiles = [];
                fileInput.value = '';
                updateFileList();
                hideFileList();
                
                // Reset server-side files
                fetch('/reset', {
                    method: 'POST'
                }).catch(console.error);
            }

            function convertFiles() {
                if (selectedFiles.length === 0) {
                    showAlert('Please select at least one file to convert');
                    return;
                }

                // Prepare UI for conversion
                fileListContainer.style.display = 'none';
                progressContainer.style.display = 'block';
                progressBar.style.width = '0%';
                progressText.textContent = '0%';
                progressStatus.textContent = 'Starting conversion...';
                conversionDetails.innerHTML = '';

                // Create FormData and append files
                const formData = new FormData();
                selectedFiles.forEach(file => {
                    formData.append('files[]', file);
                });

                // Start conversion
                fetch('word_to_pdf/convert', {
                    method: 'POST',
                    body: formData
                })
                .then(response => {
                    if (!response.ok) {
                        return response.json().then(err => Promise.reject(err));
                    }
                    return response.json();
                })
                .then(data => {
                    if (data.success) {
                        conversionResults = data.results;
                        showConversionResults(data);
                    } else {
                        showConversionError(data.error || 'Conversion failed');
                    }
                })
                .catch(error => {
                    const errorMsg = error.error || error.message || 'Conversion failed';
                    showConversionError(errorMsg);
                });
            }

            function showConversionResults(data) {
                // Update progress to 100%
                progressBar.style.width = '100%';
                progressText.textContent = '100%';
                progressStatus.textContent = 'Conversion complete!';

                // Show results
                setTimeout(() => {
                    progressContainer.style.display = 'none';
                    resultContainer.style.display = 'block';

                    // Calculate success stats
                    const totalFiles = data.results.length;
                    const successCount = data.results.filter(r => r.success).length;
                    const failedCount = totalFiles - successCount;

                    // Update summary
                    if (failedCount === 0) {
                        resultSummary.textContent = `All ${totalFiles} files converted successfully!`;
                    } else if (successCount === 0) {
                        resultSummary.textContent = `Conversion failed for all files`;
                    } else {
                        resultSummary.textContent = 
                            `${successCount} of ${totalFiles} files converted successfully`;
                    }

                    // Create download list
                    downloadList.innerHTML = '';
                    data.results.forEach(result => {
                        const resultItem = document.createElement('div');
                        resultItem.className = 'result-item';
                        
                        if (result.success) {
                            resultItem.innerHTML = `
                                <div class="result-info">
                                    <i class="fas fa-check-circle success"></i>
                                    <div>
                                        <div class="original-name">${result.original_name}</div>
                                        <div class="converted-name">→ ${result.pdf_name}</div>
                                    </div>
                                </div>
                                <a href="${result.download_url}" class="btn-download">
                                    <i class="fas fa-download"></i> Download
                                </a>
                            `;
                        } else {
                            resultItem.innerHTML = `
                                <div class="result-info">
                                    <i class="fas fa-times-circle error"></i>
                                    <div>
                                        <div class="original-name">${result.original_name}</div>
                                        <div class="error-msg">Error: ${result.error}</div>
                                    </div>
                                </div>
                            `;
                            resultItem.classList.add('error');
                        }
                        
                        downloadList.appendChild(resultItem);
                    });
                }, 500);
            }

            function showConversionError(error) {
                progressStatus.textContent = 'Error during conversion';
                conversionDetails.innerHTML = `
                    <div class="error-message">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>${error}</span>
                    </div>
                    <button class="btn-retry" id="retryBtn">
                        <i class="fas fa-redo"></i> Try Again
                    </button>
                `;

                document.getElementById('retryBtn').addEventListener('click', () => {
                    progressContainer.style.display = 'none';
                    fileListContainer.style.display = 'block';
                });
            }

            function resetConverter() {
                selectedFiles = [];
                conversionResults = [];
                fileInput.value = '';
                
                resultContainer.style.display = 'none';
                dropZone.style.display = 'block';
                
                // Reset server-side files
                fetch('word_to_pdf/reset', {
                    method: 'POST'
                }).catch(console.error);
            }

            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            function showAlert(message) {
                const alert = document.createElement('div');
                alert.className = 'alert';
                alert.innerHTML = `
                    <i class="fas fa-exclamation-circle"></i>
                    <span>${message}</span>
                    <button class="btn-close"><i class="fas fa-times"></i></button>
                `;
                
                document.body.appendChild(alert);
                
                setTimeout(() => {
                    alert.classList.add('show');
                }, 10);
                
                alert.querySelector('.btn-close').addEventListener('click', () => {
                    alert.classList.remove('show');
                    setTimeout(() => {
                        alert.remove();
                    }, 300);
                });
                
                setTimeout(() => {
                    alert.classList.remove('show');
                    setTimeout(() => {
                        alert.remove();
                    }, 300);
                }, 5000);
            }
        });
    </script>
</body>
</html>
